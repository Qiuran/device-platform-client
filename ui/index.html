<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8">
    <meta http-equiv=Content-Type content="text/html;charset=utf-8">
    <title>测试</title>
    <style rel="stylesheet" type="text/css">
        * {
            font-family: 'YaHei Consolas Hybrid';
        }
    </style>
</head>
<body>
<button onclick="doPrint()">打印</button>

<button onclick="camera.open(function(){})">打开摄像头
</button>

<button onclick="camera.close();window.clearInterval(t);t=null">关闭摄像头</button>

<button onclick="getCameraImage()">拍照</button>

<button onclick="openCamera()">实时抓取照片</button>

<img id="cameraImg"/>

<span id="inp"></span>
</body>
</html>
<script type="text/javascript">

    var t;

    function getCameraImage() {
        function doGet() {
            var base64 = camera.getImageBase64();
            if (!base64) return;
            console.log(base64);
            document.getElementById("cameraImg").src = "data:image/png;base64," + base64;
        }

        if (!camera.isOpen()) {
            camera.open(doGet);
            return;
        }
        doGet();
    }

    function getLiveCameraImage() {
        if (t) return;
        if (!camera.isOpen()) {
            camera.open();
        }
        t = window.setInterval(getCameraImage, 100)
    }

    function doPrint() {
        var template = [
            {"type": "text", "value": "${name}", "x": "100", "y": "200"}
        ];
        try {
            var res = sqlExecutor.single("select * from system_info", "");
            console.log(res);
        } catch (e) {
            console.error(e);
        }
        printer.print({
            template: JSON.stringify(template),
            data: JSON.stringify({name: "姓名"}),
            callback: function (messge) {
                window.console.log("打印:" + messge);
                return true;
            }
        });
    }

    function openCamera() {
        camera.openRecord(100, 100, 400, 400);

    }


</script>